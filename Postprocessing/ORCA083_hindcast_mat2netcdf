#!/usr/bin/env python
"""
Copyright Netherlands eScience Center
Function        : Save OMIP hindcast on ORCA083 from mat to netcdf (from Ben Moat)
Author          : Yang Liu
Date            : 2018.01.15
Last Update     : 2018.01.16
Description     : The code aims to wrap the time series of heat transport at 26.5 N
                  from a hindcast with NEMO-LIM model on ORCA012 grid. The hindcast
                  is accomplished by Ben Moat et. al. in National Oceanography Center.
Return Value    : NetCFD4 data file
Dependencies    : os, time, numpy, netCDF4, sys, matplotlib, logging
variables       : Atmospheric Meridional Energy Transport   ERA-Interim
                  Oceanic Meridional Energy Transport       ORAS4
Caveat!!        : The temporal resolution is monthly. The data ranges from 1958 to
                  2012. The data is the synthesis of heat transport and mass transport
                  across 26.5N in the Atlantic Ocean
"""

import numpy as np
import scipy
import seaborn as sns
#import scipy as sp
import time as tttt
from netCDF4 import Dataset,num2date
import os
import platform
import sys
import logging
import matplotlib

################################   Read .mat file  ######################################
# specify data path
#datapath = '/home/yang/NLeSC/Computation_Modeling/BlueAction/Oceanography/ORCA083hindcast_BenMoat'
#key_dict = scipy.io.loadmat(datapath + os.sep + 'ORCA083_TRANS.mat')
#value = key_dict['ORCA12'][0]
####################################################################################
# time series from .mat file
# Atlantic Heat Transport
OMET = np.array([
         0.36694657,  0.32362889,  0.53030104,  0.82476025,  1.0652702 ,
         0.83300695,  1.1109044 ,  1.14604094,  0.94516658,  1.09707982,
         1.25751136,  0.90116187,  0.66409687,  0.92115462,  0.84305928,
         0.81671066,  0.8191731 ,  0.77139333,  0.90680213,  0.89766442,
         0.96809872,  0.96741597,  1.11996931,  1.38597974,  0.71339585,
         0.51502314,  0.71226127,  1.15941017,  0.70754504,  0.88037078,
         1.0534715 ,  1.07721943,  1.10989933,  0.81415228,  1.19895548,
         1.13934763,  1.11107427,  0.83285523,  0.76323741,  0.90296717,
         1.00543648,  1.11077043,  1.05562654,  1.20515354,  1.20396195,
         1.22259804,  1.03444796,  0.8594152 ,  1.28943808,  1.00225338,
         0.30298408,  1.31697178,  0.9511555 ,  0.95507662,  0.95868996,
         1.21428528,  1.16099168,  0.98777637,  1.06661877,  0.96455996,
         0.83454063,  0.89311544,  1.1546538 ,  0.74153589,  1.10733869,
         0.99234773,  1.11796188,  1.1898726 ,  1.21037508,  1.02340026,
         0.87985372,  0.82441658,  0.86736508,  1.00026821,  0.75622168,
         1.21345152,  1.02428397,  0.85629742,  1.32686388,  1.10356101,
         1.1307583 ,  1.22163068,  1.14281279,  1.17115667,  0.97689591,
         0.67762756,  0.82178714,  1.04305984,  0.93399645,  0.98306753,
         1.19178228,  1.24299411,  1.20902683,  1.07417402,  1.20256425,
         1.1021025 ,  0.63756802,  0.70674001,  0.81685301,  0.87169468,
         1.20506869,  0.98049758,  1.11259214,  1.19251829,  1.18064993,
         1.05164235,  1.20498339,  1.31932132,  1.07763068,  1.16699479,
         1.06198901,  0.79250813,  1.02893647,  0.90286857,  1.19332731,
         1.26794986,  1.10684902,  1.31386264,  1.31225315,  0.75990123,
         1.0984165 ,  0.60236121,  0.93416396,  0.94440288,  0.94202601,
         0.97637905,  0.92602871,  0.93720822,  0.94605055,  1.02822126,
         1.05920304,  0.89780379,  0.70881198,  0.34616841,  0.48037275,
         1.34951582,  1.14048275,  0.9047847 ,  1.127029  ,  1.31984494,
         1.20693084,  1.07990425,  0.88387416,  1.0055916 ,  0.58306818,
         1.29126006,  0.83490686,  0.91431532,  0.99108678,  0.92872058,
         1.17855868,  1.31779885,  1.22796241,  1.03662891,  0.9307189 ,
         0.7474348 ,  0.85880534,  1.30278523,  0.96384892,  0.79713504,
         0.95935558,  0.93163973,  1.15911783,  1.27138688,  0.979383  ,
         1.16960887,  0.96578146,  1.23814889,  1.32875278,  1.15932041,
         1.02589641,  0.99381106,  1.15512268,  1.04854303,  1.04860615,
         0.97093476,  0.90757281,  1.09028396,  1.07445444,  1.34205877,
         0.84667021,  1.11670263,  1.02102552,  0.96480143,  1.14714872,
         1.19257754,  1.14518176,  1.33439831,  1.12443144,  1.08821926,
         0.99313192,  1.16816948,  1.36533537,  1.26454935,  1.19399877,
         1.18178632,  0.95721559,  0.98960761,  1.19841323,  1.20424877,
         1.34516126,  1.28764002,  1.15682168,  1.37065705,  1.43464859,
         0.98066252,  1.07090465,  1.03069708,  0.97708951,  0.91881726,
         1.21642292,  1.21815874,  1.39165318,  1.41933908,  1.20933984,
         1.08466703,  1.12861642,  1.39157335,  1.12534831,  0.85552007,
         1.00032657,  0.96848502,  0.7196999 ,  1.04977467,  1.04948916,
         1.44258974,  1.33663647,  1.16335972,  0.70156881,  1.09311651,
         1.03511687,  1.37328893,  1.21946963,  0.75848981,  1.14498995,
         1.2796035 ,  1.03014719,  1.08073209,  1.25206198,  1.03015424,
         1.24813983,  0.31235033,  1.00138934,  1.02253604,  1.02383746,
         0.82628695,  1.24281438,  1.06374307,  0.97278302,  1.00643702,
         1.1440192 ,  0.94478946,  0.82016892,  0.53631952,  1.11522639,
         1.03560945,  1.1143627 ,  1.06503223,  1.09904912,  1.34831127,
         1.25401495,  1.15664754,  1.43037277,  1.12052787,  0.76542656,
         0.88662216,  1.00270912,  1.05256998,  0.79182551,  1.09225112,
         1.33636435,  1.28979851,  1.32812613,  1.22316482,  1.15331724,
         1.32503408,  1.10997275,  1.55083625,  0.59681378,  1.1596924 ,
         1.06871668,  1.08744723,  1.21409376,  1.26542469,  0.93135128,
         1.17143525,  1.31254043,  1.00606079,  0.94483081,  1.33234152,
         1.36922358,  1.15042008,  1.06233895,  0.82830467,  1.21572411,
         1.29558303,  1.34202808,  1.10287078,  1.21269986,  1.48144386,
         1.21227043,  0.59144947,  0.90327299,  0.95505747,  1.17640324,
         0.91654864,  1.09467374,  1.15567871,  1.09610473,  0.95297079,
         0.6988837 ,  1.25167495,  1.5268689 ,  1.48011098,  0.9903628 ,
         0.88426761,  1.27298727,  1.17617966,  1.25315062,  1.11820313,
         1.17038216,  1.19392551,  0.87755092,  1.27977276,  0.73665342,
         0.95625479,  1.10121293,  1.18079497,  0.87930584,  0.76663366,
         1.10378512,  1.23096924,  1.11445291,  1.37091539,  1.44762776,
         0.97479065,  1.35325936,  0.9535458 ,  1.06826456,  1.00781904,
         0.87583824,  1.21675859,  1.17946643,  1.20119234,  1.10052359,
         1.27743355,  1.51206293,  1.14680477,  0.74338812,  0.82533718,
         0.83698197,  1.00840463,  1.15751941,  1.11014447,  1.09868576,
         1.13594772,  1.10347349,  1.27537966,  1.33777948,  1.00654493,
         1.03113687,  1.30810229,  1.25763552,  1.02111316,  1.00769953,
         1.16273519,  1.34518349,  1.2724513 ,  1.39947766,  1.27580634,
         1.25353238,  1.13531071,  1.29835198,  1.28725404,  1.13232758,
         1.20526127,  1.01704131,  1.01843336,  1.13215858,  1.18799304,
         1.34863015,  1.07589819,  1.30904382,  0.78183499,  1.52138036,
         1.40928919,  1.28449237,  1.17685764,  0.98176449,  1.1903307 ,
         1.23531419,  1.0425331 ,  1.17788041,  1.26998566,  1.15331037,
         1.22010862,  1.09388535,  1.08331637,  0.88670473,  1.08472583,
         1.07495524,  1.05780735,  1.13869524,  1.16806165,  1.03393507,
         1.10146268,  1.27783078,  1.25229754,  0.93448974,  1.11905807,
         1.33701223,  1.14869874,  1.09695068,  1.00626369,  1.25094399,
         1.31124254,  1.42570752,  0.99460414,  1.72711949,  1.14003517,
         1.38421738,  1.03536563,  1.18728524,  0.9681227 ,  1.07264299,
         1.02794319,  1.09098259,  1.32942561,  1.41082843,  1.23103537,
         1.40567692,  1.24577632,  1.6511538 ,  1.2324038 ,  1.19798986,
         1.42905955,  1.25468363,  0.94219651,  1.20444066,  1.22305214,
         1.37722339,  1.20193357,  1.37899534,  1.27840021,  1.43278112,
         1.12012862,  1.13611487,  0.84136885,  0.885544  ,  1.04865172,
         1.16064618,  1.29377768,  1.12699327,  1.27057668,  1.1488997 ,
         0.81817197,  0.9780293 ,  1.15382133,  0.93617741,  1.18122797,
         1.09203322,  1.07732001,  1.2783831 ,  1.22602359,  1.23900604,
         1.13145041,  1.29916914,  0.90896522,  0.98537113,  1.36768618,
         1.13432571,  0.62348236,  1.03670468,  0.65254992,  1.00167583,
         1.20407104,  1.09198768,  0.93872405,  1.10056585,  0.96253725,
         1.02647519,  0.51907713,  1.14812492,  1.15583707,  0.8443714 ,
         1.01941577,  1.26510247,  1.33477741,  1.14546387,  1.20499915,
         1.15112989,  1.33663266,  1.29714852,  0.82513714,  0.90884821,
         0.89120619,  0.72530794,  0.98886068,  0.9963529 ,  1.13019641,
         1.21457536,  1.13177184,  1.2333616 ,  0.97850919,  1.07355468,
         1.22829649,  0.80189414,  0.87907275,  0.94745022,  1.01350351,
         0.95709903,  1.12830762,  0.93307824,  1.03881893,  0.96956446,
         1.03567509,  0.77520519,  1.0183099 ,  0.6736439 ,  1.05477207,
         0.83065084,  0.73157275,  1.14477814,  1.08460234,  0.90720462,
         1.12968944,  0.99261479,  0.9023076 ,  1.28990373,  0.92349671,
         1.02296863,  1.11644517,  1.18959659,  0.9276911 ,  1.12351753,
         0.90015387,  0.95980229,  0.70714529,  1.15758236,  0.7779204 ,
         0.83280936,  1.25527499,  0.83355039,  0.80827594,  0.88706017,
         0.9252948 ,  1.22832491,  1.21456645,  1.02489122,  1.04185921,
         1.30803019,  0.96860522,  0.82030361,  0.68473159,  1.01820663,
         0.92091386,  1.05618513,  0.79974157,  1.00342385,  0.81084839,
         1.01088544,  0.66441404,  0.85641502,  1.2377008 ,  1.04268319,
         0.56716121,  0.52659747,  0.76256621,  0.78353217,  0.86448074,
         0.98437935,  0.9839567 ,  1.18657378,  1.12010517,  1.2712879 ,
         0.88345282,  1.27754464,  0.92219775,  0.71668397,  0.80027116,
         0.83827922,  1.09906369,  1.29761448,  0.99886515,  1.12392737,
         1.00149841,  1.0020778 ,  1.26020199,  1.18907751,  0.6826169 ,
         1.10327331,  0.67401051,  1.01076807,  0.70889451,  1.07075343,
         1.06534809,  1.05707699,  1.1477992 ,  0.89947616,  1.18508713,
         1.05161847,  1.02185774,  0.96684378,  0.79896759,  0.56796848,
         0.72529067,  0.99141418,  1.06006391,  1.00096358,  1.04032281,
         0.85435973,  1.19427009,  1.03941506,  0.80372528,  0.78320175,
         0.92119631,  0.95768789,  0.57197538,  0.71972447,  1.14534801,
         1.02669932,  0.74060862,  0.9931689 ,  0.6821518 ,  0.52741818,
         0.3704134 ,  0.37107   ,  0.56979565,  0.7337865 ,  0.92281921,
         1.15024874,  1.01465564,  1.33009356,  1.19586055,  0.91456186,
         0.24199037,  0.8797349 ,  1.08431562,  0.76295588,  1.15861665,
         0.69028458,  0.65689068,  1.12458768,  1.12055043,  1.19102319,
         1.17340959,  0.97086387,  1.27378556,  1.01523564,  0.92236005,
         1.20597746,  0.74031412,  0.8258043 ,  0.59674343,  1.206807  ,
         0.87063769,  0.77702134,  0.88058971,  0.90784606,  1.00978995],dtype=float)
# Atlantic Mass Transport
psi = np.array([
         12.07635806,  10.09626694,  11.96352291,  15.11116521,
         17.81634887,  13.82364305,  17.33588886,  17.45105902,
         14.53540643,  16.61959362,  18.37567584,  12.42093236,
         10.75486946,  12.92341747,  11.93866791,  12.60921192,
         13.42952649,  13.56648556,  14.21189451,  14.60139004,
         15.25985161,  15.68925349,  15.2891806 ,  17.52009732,
         10.04751237,  10.04969947,  11.8304855 ,  18.52019993,
         11.19526625,  14.88566287,  17.14924924,  16.58906555,
         17.21658611,  13.52878979,  17.51347987,  16.61886597,
         17.61008342,  13.57654953,  11.8244353 ,  14.96070989,
         16.9331549 ,  17.11099545,  14.94963344,  18.98814583,
         19.41938814,  18.53390916,  15.77818473,  11.48683466,
         19.50884517,  15.86382484,   5.88910399,  18.70890665,
         15.05119371,  14.08116388,  15.077552  ,  17.73700158,
         17.40158621,  16.15167602,  16.63509927,  14.6906387 ,
         14.51727994,  15.14141788,  17.32340867,  10.10288747,
         15.7117095 ,  16.32396142,  17.10244195,  18.34483751,
         17.66918882,  16.09792185,  15.77059428,  14.08962563,
         15.32851442,  15.72678852,  11.25207424,  18.51697461,
         16.15091991,  13.74393288,  19.28708744,  17.55395873,
         17.54531527,  18.59651566,  17.52367751,  16.45614052,
         14.02555164,  11.29461937,  13.11686979,  16.87345187,
         15.96680228,  17.47876962,  19.71677081,  19.78186639,
         18.44754823,  16.64589564,  17.73734681,  16.09695475,
         11.38868674,  12.26419439,  12.19516577,  16.04450305,
         19.54389159,  14.94679133,  18.20301676,  17.88374274,
         17.82811022,  15.29996649,  17.92214521,  17.71081988,
         15.64409494,  17.76146946,  15.93721948,  11.18257602,
         16.34918769,  15.89564705,  19.09926001,  19.90723006,
         17.06030893,  19.83945084,  19.02001354,  10.28265675,
         16.57790629,  11.36923854,  15.53055716,  16.28008986,
         16.38238557,  16.84575637,  15.70368226,  14.8471117 ,
         15.73462915,  18.03259986,  16.72513247,  15.69444418,
         14.9006416 ,   8.61865712,   9.71596261,  20.6547308 ,
         18.99856631,  15.4612511 ,  19.05171522,  21.91786544,
         19.23188146,  17.10191011,  14.17273188,  15.8281893 ,
         11.20952781,  21.71530647,  14.77357183,  15.98078537,
         15.87704341,  15.55344947,  19.43520705,  21.81813812,
         19.28697936,  16.51985614,  14.26520332,  11.83899682,
         14.93257602,  20.56908665,  15.7196128 ,  13.60409117,
         15.96974579,  17.29008198,  19.41118209,  19.67459583,
         17.35290813,  18.233929  ,  16.39488538,  19.3974732 ,
         20.11672656,  16.82571173,  17.27552255,  16.45930338,
         19.05575593,  17.80845356,  17.58995056,  16.93079837,
         17.52827692,  18.49237633,  16.12476365,  16.51181904,
         14.4916455 ,  18.05051346,  14.47584418,  15.95041863,
         19.02290487,  20.32481194,  18.96019777,  21.77663326,
         19.57998117,  17.93514109,  14.67828735,  16.63149766,
         20.21603489,  21.73279076,  18.52781364,  17.98537763,
         17.78575246,  15.84232442,  17.81966368,  17.55584923,
         20.02062098,  22.06517251,  18.50878445,  20.16404561,
         20.71427027,  16.82135792,  17.94500405,  17.80721839,
         17.04720815,  17.17042685,  19.64215628,  19.8077027 ,
         21.35760053,  20.77600956,  17.36622492,  15.29997935,
         17.19917425,  22.96687698,  19.18405517,  13.77733103,
         17.39054505,  17.39320103,  13.20512835,  17.39732869,
         18.82002862,  22.17491313,  19.84174951,  17.27439276,
         12.84874789,  17.77126884,  16.61855221,  21.01424408,
         20.81685877,  14.49666023,  19.17741267,  20.14532375,
         17.49641864,  17.69848824,  19.44205618,  17.66449438,
         21.46513844,   7.90303175,  15.42092405,  17.83920558,
         18.18904082,  15.14821068,  22.7237676 ,  18.35923147,
         16.85571591,  17.91897647,  17.31058486,  15.82400145,
         16.18204459,  10.98286963,  20.08882945,  17.8557024 ,
         18.73912827,  19.64460214,  19.44332631,  22.70839024,
         20.50595983,  19.50598971,  22.36626816,  18.73599843,
         14.43940957,  18.07727035,  17.65316836,  17.71198448,
         14.44417795,  17.3390468 ,  21.45317046,  20.41205899,
         20.87004312,  20.47372736,  17.62194792,  18.05266253,
         16.65602589,  22.72071037,  10.18140718,  17.84471528,
         17.82215246,  18.67142741,  18.80767123,  19.91665109,
         16.34123739,  18.85035785,  19.01630084,  14.51988356,
         16.39621147,  20.06627007,  21.42400932,  18.36491585,
         16.77942944,  16.16569614,  18.61790848,  21.85177358,
         21.98409017,  17.22932482,  17.46867911,  21.04202025,
         18.93599637,  11.15426493,  17.17239053,  18.11340173,
         19.80626361,  15.43919627,  18.79824924,  19.04862595,
         19.6086731 ,  16.18071111,  12.61259826,  20.10128839,
         24.46159999,  23.94900322,  15.6637044 ,  14.9196744 ,
         19.83683427,  19.46963247,  20.98820337,  18.73610544,
         20.0306104 ,  18.737857  ,  14.34391371,  19.95605707,
         14.77624162,  16.63981857,  17.27474867,  18.04576842,
         15.91643556,  14.21542295,  19.44749896,  20.86199284,
         19.92724959,  20.5004673 ,  21.90341393,  17.02402088,
         22.70476309,  17.0727047 ,  16.37146132,  16.27926747,
         15.5196236 ,  21.3478206 ,  19.09038862,  18.68133767,
         18.00135358,  20.17067964,  21.21272786,  18.03159539,
         15.14114539,  15.741362  ,  13.03813389,  16.53132041,
         17.85577106,  17.38547802,  19.16792107,  19.11083794,
         17.07477633,  18.35939884,  19.73026196,  15.55757509,
         16.50603946,  21.897542  ,  19.13979959,  17.01040252,
         16.6918745 ,  20.70276324,  22.28991445,  20.9111948 ,
         21.89542898,  21.22431128,  19.57938385,  16.54124022,
         20.10672092,  22.25066452,  18.29256044,  20.15884431,
         16.66216421,  16.57869053,  18.19526927,  19.81170813,
         20.91488775,  17.95938301,  20.18496418,  12.69472572,
         23.76574707,  22.26683311,  20.02918775,  18.94735336,
         18.05526638,  20.07499313,  19.80275313,  17.74313943,
         19.56260236,  19.01045259,  18.32446153,  19.19529088,
         18.3309563 ,  17.79578648,  14.83479636,  18.15423997,
         20.08018271,  19.56256564,  21.26863575,  20.79980946,
         19.15645568,  19.68053277,  23.38862928,  19.29450158,
         16.37178167,  20.24222453,  22.86363061,  18.99719938,
         17.65885115,  18.60790475,  22.3549331 ,  20.63894463,
         23.32947318,  17.82312311,  25.34498596,  17.51163292,
         22.98612054,  19.23384171,  20.91061074,  17.97948217,
         21.39537875,  21.58790048,  23.42897924,  23.12823391,
         23.6884648 ,  22.55646674,  23.00245857,  20.76906667,
         24.30055459,  20.1022728 ,  19.30112444,  23.10705058,
         20.94392586,  17.35436169,  19.53561751,  19.78520298,
         22.61625036,  20.64666875,  19.45342   ,  17.76885264,
         21.04436811,  18.91597061,  18.69848524,  14.51108678,
         16.87799994,  19.0630242 ,  18.61312183,  20.26854483,
         20.06399314,  21.99560738,  18.64759509,  13.67804759,
         16.13841931,  20.58675162,  17.57684851,  19.78521299,
         19.46368694,  19.03876527,  21.82893085,  19.05871105,
         19.66334057,  18.41671276,  19.16567612,  13.28514051,
         17.43758615,  20.47305298,  17.57633291,   9.48655589,
         16.01081912,  12.03350751,  16.16469987,  20.42113622,
         18.56335576,  16.22116375,  17.35350784,  16.67614501,
         16.45125779,  10.28502345,  19.78657722,  18.76064889,
         14.08479675,  17.09401226,  19.93420474,  20.27058125,
         17.73900604,  19.10351276,  18.49931622,  18.6305888 ,
         19.21400563,  13.27509899,  15.46019663,  14.8094101 ,
         12.54561869,  17.4103837 ,  16.66655   ,  19.70192242,
         20.43770091,  18.29573472,  19.27205849,  16.41690241,
         17.67846982,  21.7654508 ,  16.67036835,  15.78694582,
         16.31041781,  17.39732329,  15.3741641 ,  18.6923914 ,
         16.2343456 ,  17.76425893,  18.89142323,  17.0877099 ,
         14.12091827,  17.70725765,  12.37639884,  18.04045995,
         15.50580422,  14.02601592,  18.40059535,  17.67856916,
         16.81928587,  17.23476044,  17.10107327,  13.45088264,
         20.70890999,  16.59112225,  16.905059  ,  17.91355753,
         17.79826466,  14.26684507,  16.7258536 ,  14.76274474,
         16.58053652,  13.54299672,  17.83650557,  12.76082775,
         13.14659977,  19.20155678,  14.87314061,  13.53651738,
         15.22295491,  15.8988018 ,  18.99360116,  20.32498741,
         16.79573075,  16.01339833,  19.76736768,  14.89047595,
         14.50764179,  12.80713749,  16.25709724,  14.52355099,
         16.51781336,  14.39933348,  15.78625329,  14.35464859,
         16.57012812,  12.9117025 ,  12.48975341,  18.81118886,
         18.88573567,  11.04517531,  12.35618264,  16.0933876 ,
         14.68677489,  16.87978013,  17.91300456,  17.49038124,
         20.69177469,  17.72446871,  17.75388972,  13.85784544,
         19.75722822,  15.52866497,  11.98276779,  10.8214488 ,
         14.29532846,  18.15953541,  20.11011759,  15.6537919 ,
         16.4445281 ,  16.12083085,  14.29385614,  17.51118224,
         17.6823748 ,  11.29556599,  16.46918842,  11.53147952,
         16.75845242,  13.85965951,  17.1219271 ,  16.87347921,
         17.61692397,  19.60904376,  13.44507964,  17.29259477,
         16.61127154,  15.85219924,  15.84054216,  14.36444648,
          9.82052271,  12.49720732,  16.01427809,  16.16998402,
         15.1731081 ,  16.63227299,  14.22880141,  18.57679574,
         16.26555856,  14.6309185 ,  13.00460625,  14.14063168,
         16.49747992,  13.32483498,  12.46853733,  18.34824657,
         16.53805796,  12.93334452,  14.97555415,  10.95374959,
         10.1431946 ,   9.36765108,   7.95802593,  10.93771815,
         14.35588916,  16.84662485,  17.23852793,  15.5483044 ,
         20.41231314,  19.15555938,  14.65154274,   4.93645548,
         15.85898495,  18.95375938,  13.5095208 ,  17.23502096,
         11.6146493 ,  11.6437033 ,  18.55109564,  18.10169967,
         19.47956117,  18.95513137,  13.4926947 ,  16.53442805,
         17.25163635,  16.07734076,  18.92757384,  11.01892312,
         13.83371862,  11.01776783,  18.67709796,  14.26730378,
         14.15145493,  13.76674124,  12.77061526,  15.94211578],dtype=float)

year = np.arange(1958,2013,1)
month = np.arange(1,13,1)

OMET_reshape = OMET.reshape(len(year),len(month))
psi_reshape = psi.reshape(len(year),len(month))

############################   create .netcdf file  ###############################
# wrap the datasets into netcdf file
# 'NETCDF3_CLASSIC', 'NETCDF3_64BIT', 'NETCDF4_CLASSIC', and 'NETCDF4'
output_path = '/home/yang/NLeSC/Computation_Modeling/BlueAction/Oceanography/ORCA083hindcast_BenMoat'
data_wrap = Dataset(output_path + os.sep + 'OMET_psi_hindcast_ORCA083_1958-2012_Atlantic_2605.nc' ,'w',format = 'NETCDF3_64BIT')
# create dimensions for netcdf data
year_wrap_dim = data_wrap.createDimension('year',len(year))
month_wrap_dim = data_wrap.createDimension('month',len(month))
# create coordinate variables for 3-dimensions
year_wrap_var = data_wrap.createVariable('year',np.int32,('year',))
month_wrap_var = data_wrap.createVariable('month',np.int32,('month',))
OMET_wrap_var = data_wrap.createVariable('E',np.float64,('year','month'))
psi_wrap_var = data_wrap.createVariable('psi',np.float64,('year','month'))
# global attributes
data_wrap.description = 'Monthly mean meridional energy transport on ORCA083 grid at 26.5N'
OMET_wrap_var.units = 'peta watt'
psi_wrap_var.units = 'Sv'

year_wrap_var.long_name = 'year'
month_wrap_var.long_name = 'month'
OMET_wrap_var.long_name = 'Monthly mean meridional energy transport at 26.5N'
psi_wrap_var.long_name = 'Monthly mean mass transport at 26.5N'
# writing data
year_wrap_var[:] = year
month_wrap_var[:] = month
OMET_wrap_var[:] = OMET_reshape
psi_wrap_var[:] = psi_reshape
# close the file
data_wrap.close()
